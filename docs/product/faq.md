# 常见问题

## 打开文档提示「下载失败」

开档时传递的文件地址是需要在容器内部下载并转换的，所以一定要保证地址在容器内可正常下载。

- 不能使用 `127.0.0.1` 或 `localhost` 一类的域名或地址，容器内会请求到自己内部
- 如果是使用了 `https` 协议的地址，一定要保证证书是正式的而不是自己颁发的，否则也可能失败

总之下载失败时可以查看容器日志，内部会清晰的告诉你为什么失败。

## 提示「安全令牌格式不正确」

onlyoffice documentserver 默认开启了 jwt 认证，你如果执意开启，可参考官方文档 [签名](https://api.onlyoffice.com/docs/docs-api/additional-api/signature/)。如果非必要，建议按以下操作

- 启动容器时，使用环境变量关闭认证 `JWT_ENABLED=false`
- 打开文档时将 `token` 留空

以上两条需要同时达到才可以解决此问题。

## 授权不生效

中国版使用授权文件进行高级版授权。如发现不生效，可以从以下方面排查：

- 查看容器日志，如果提示 `License does not exist or parsing failed` 说明授权文件不存在或内容已经被破坏无法解析，请仔细核对文件位置
- 如果提示 `License is illegal` 说明机器码不匹配或已经授权失效
- 核对机器码是否变动 [查询机器码](./vip#查询机器码)，可能由于启动容器时没有使用特权模式或没有正确挂载目录 [启动容器](./vip#启动容器)
- 宿主机硬件信息是否发生变化。机器码依赖宿主机硬件信息（主板/CPU/网卡），有时候云服务器某些配置操作也会导致信息变化。请使用硬件信息稳定的宿主机服务器。

## 如何部署 https

不建议在 documentserver 内部部署证书开启 https。相对合理的做法是在最前端的出口服务器（nginx 一类）上部署证书并做反向代理

## 部署 https 后发现存在部分 http 请求

此种情况大部分出现在你做了 30x 跳转，或者你配置的 https CDN 回源的是 http 地址。CDN 上回源地址需要和源站地址一样，否则内部检测 https 协议会失败，从而返回了 http 的下载地址

## 如何子目录部署

中国版已经适配子目录部署，具体见 [子目录部署](../feature/basepath.md)。

## 无法复制，控制台提示没有 `copy` 权限

documentserver 在开档时使用参数 `document.permissions.copy` 配置控制是否允许复制。请仔细核对你的集成参数。

另外，documentserver 的默认逻辑是快捷键读写的是系统剪切板内容，鼠标右键读写的是内部剪切板内容，需要注意操作习惯。
